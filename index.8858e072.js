var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},e={},s={},r=t.parcelRequire4cc0;null==r&&((r=function(t){if(t in e)return e[t].exports;if(t in s){var r=s[t];delete s[t];var i={id:t,exports:{}};return e[t]=i,r.call(i.exports,i,i.exports),i.exports}var o=Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(t,e){s[t]=e},t.parcelRequire4cc0=r),(0,r.register)("efyfk",function(t,e){t.exports=class{constructor(t){this.initialState=t?t.map(t=>[...t]):Array.from({length:4},()=>[,,,,].fill(0)),this.state=this._clone(this.initialState),this.score=0,this.status="idle",this.started=!1}_clone(t){return t.map(t=>[...t])}_getEmptyCells(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.state[e][s]&&t.push([e,s]);return t}_addRandomCell(){let t=this._getEmptyCells();if(!t.length)return;let[e,s]=t[Math.floor(Math.random()*t.length)];this.state[e][s]=.9>Math.random()?2:4}_transpose(t){return t[0].map((e,s)=>t.map(t=>t[s]))}_reverseRows(t){return t.map(t=>[...t].reverse())}_mergeRow(t){let e=t.filter(Boolean),s=[],r=0;for(let t=0;t<e.length;t++)if(e[t]===e[t+1]){let i=2*e[t];s.push(i),r+=i,t++}else s.push(e[t]);for(;s.length<4;)s.push(0);return{row:s,score:r}}_boardsEqual(t,e){return t.flat().every((t,s)=>t===e.flat()[s])}_canMove(){let t=this.state;if(t.flat().includes(0))return!0;for(let e=0;e<4;e++)for(let s=0;s<3;s++)if(t[e][s]===t[e][s+1])return!0;for(let e=0;e<4;e++)for(let s=0;s<3;s++)if(t[s][e]===t[s+1][e])return!0;return!1}getState(){return this._clone(this.state)}getScore(){return this.score}getStatus(){return this.status}start(){"idle"===this.status&&(this.state=this._clone(this.state),this.status="playing",this._addRandomCell(),this._addRandomCell(),this.started=!0)}restart(){this.state=this._clone(this.initialState),this.score=0,this.status="idle",this.started=!1}_moveBase(t,e){let s=this._clone(t),r=0;("up"===e||"down"===e)&&(s=this._transpose(s)),("right"===e||"down"===e)&&(s=this._reverseRows(s));let i=s.map(t=>{let{row:e,score:s}=this._mergeRow(t);return r+=s,e});return("right"===e||"down"===e)&&(i=this._reverseRows(i)),("up"===e||"down"===e)&&(i=this._transpose(i)),{result:i,totalScore:r}}_move(t){if(!this.started||"playing"!==this.status)return;let{result:e,totalScore:s}=this._moveBase(this.state,t);if(!this._boardsEqual(this.state,e)){if(this.state=e,this.score+=s,this.state.flat().includes(2048)){this.status="win";return}this._addRandomCell(),this._canMove()||(this.status="lose")}}moveLeft(){this._move("left")}moveRight(){this._move("right")}moveUp(){this._move("up")}moveDown(){this._move("down")}}}),r("efyfk");
//# sourceMappingURL=index.8858e072.js.map
